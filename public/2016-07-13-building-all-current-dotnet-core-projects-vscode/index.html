<!DOCTYPE html>






<html prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Jonathan Channon Blog - Building all and current dotnet core projects in VSCode</title>
        <meta name="description" content="As you may or may not know I try to work on OSX as much as possible and with .Net that&rsquo;s quite painful to be honest.  Things are moving along nicely with Jetbrains Rider,
VSCode, Xamarin and Omnisharp.  I&rsquo;ll be honest, none of them are perfect and I often find myself using Visual Studio in a VM because it just works (yes, its clunky etc etc).
Recently, VSCode got a 1.3 release with some new features, tabs being one of them.  I never really got on with VSCode so dismissed it most of the time but this new release
opened my eyes a bit more and thought I&rsquo;d give it a go.  Its C# support now runs on .Net Core RTM and most of my work at the moment is porting projects to .Net Core so it seemed
this would be worthwhile.  I&rsquo;ve tried to setup keybindings that are the ones I know from Visual Studio and installed couple of extensions to make things easier and prettier.
As VSCode is language agnostic the one thing I found was how to build .Net Core projects was a bit off.  For each project you have you have to configure a task runner.  VSCode tries to
help you here and gives you a few languages to choose from.  For .Net Core it creates a dotnet build task.  The problem with this is that it runs that command from the workspace root,
ie the folder where VSCode is opened.  What if you open it from the git root folder and your project(s) are under a src/MyProject folder?  It will fail as it cant find project.json.
What you can do is set the cwd to be a specific directory by hardcoding it in the task configuration but thats not great if you have multiple projects.  You could use some predefined
variables that VSCode provides eg/${fileDirname} but again if you are in a folder 4 levels deep that wont work either.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.69.2" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="9bvoj2jXRyykef2Tg72C0Am15YBTqDF0RgeZ84tUytE" />
        <meta property="og:title" content="Building all and current dotnet core projects in VSCode">
<meta property="og:description" content="As you may or may not know I try to work on OSX as much as possible and with .Net that&rsquo;s quite painful to be honest.  Things are moving along nicely with Jetbrains Rider,
VSCode, Xamarin and Omnisharp.  I&rsquo;ll be honest, none of them are perfect and I often find myself using Visual Studio in a VM because it just works (yes, its clunky etc etc).
Recently, VSCode got a 1.3 release with some new features, tabs being one of them.  I never really got on with VSCode so dismissed it most of the time but this new release
opened my eyes a bit more and thought I&rsquo;d give it a go.  Its C# support now runs on .Net Core RTM and most of my work at the moment is porting projects to .Net Core so it seemed
this would be worthwhile.  I&rsquo;ve tried to setup keybindings that are the ones I know from Visual Studio and installed couple of extensions to make things easier and prettier.
As VSCode is language agnostic the one thing I found was how to build .Net Core projects was a bit off.  For each project you have you have to configure a task runner.  VSCode tries to
help you here and gives you a few languages to choose from.  For .Net Core it creates a dotnet build task.  The problem with this is that it runs that command from the workspace root,
ie the folder where VSCode is opened.  What if you open it from the git root folder and your project(s) are under a src/MyProject folder?  It will fail as it cant find project.json.
What you can do is set the cwd to be a specific directory by hardcoding it in the task configuration but thats not great if you have multiple projects.  You could use some predefined
variables that VSCode provides eg/${fileDirname} but again if you are in a folder 4 levels deep that wont work either.">
<meta property="og:type" content="article">
<meta property="og:url" content="/2016-07-13-building-all-current-dotnet-core-projects-vscode/">
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700%7CCourgette' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="/dist/site.css">
        <link rel="stylesheet" href="/dist/syntax.css">
        <link rel="stylesheet" href="/dist/screen.css" media="screen" >
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
            <link href="/2016-07-13-building-all-current-dotnet-core-projects-vscode/feed.xml" rel="alternate" type="application/rss+xml" title="Jonathan Channon Blog">
        
        
        
        
    </head>
    <body>
        

        <div class="body_wrap">
            <div class="logo">
                <strong><a href="index.html">Blog</a></strong>
                <div class="logo_description">curated by Jonathan Channon</div>
            </div>
            
            <div class="header">            
                <div class="header_inner">
                        
                    <nav id="topmenu" class="clearfix">
                        <ul class="dropdown">
                            <li class="menu-item-blue"><a href="/"><span>Home</span></a></li>
                            <li class="menu-item-pink"><a href="/archive"><span>Archive</span></a></li>
                        </ul>
                    
                    <select id="topm-select" onChange="location = this.value">
                        <option value="">Site Navigation</option>
                        <option value="/">Home</option>
                        <option value="/about">About Me</option>

                        <option value="/archive">Archive</option>
                        <option value="/contact">Contact</option>
                    </select>
                    </nav>    
                    

                </div>
            </div>
              
            
            <div id="middle" class="full_width">
                <div class="container clearfix">                        
                    
                    <div> 
            


<div class="post-item boxed post-detail" itemtype="http://schema.org/BlogPosting">
    <span class="post-label label-quotes"></span>           
    <div class="post-title">
      <h1><a href="/2016-07-13-building-all-current-dotnet-core-projects-vscode/">Building all and current dotnet core projects in VSCode</a></h1>
    </div>
    <div class="post-meta-top">
        <span class="post-date">July 13, 2016</span> 
        
        <div class="commentcount" data-disqus-url="/2016-07-13-building-all-current-dotnet-core-projects-vscode/"></div>
    </div>
    
    <div class="post-descr entry">
        <p>As you may or may not know I try to work on OSX as much as possible and with .Net that&rsquo;s quite painful to be honest.  Things are moving along nicely with Jetbrains Rider,
VSCode, Xamarin and Omnisharp.  I&rsquo;ll be honest, none of them are perfect and I often find myself using Visual Studio in a VM because it just works (yes, its clunky etc etc).
Recently, VSCode got a 1.3 release with some new features, tabs being one of them.  I never really got on with VSCode so dismissed it most of the time but this new release
opened my eyes a bit more and thought I&rsquo;d give it a go.  Its C# support now runs on .Net Core RTM and most of my work at the moment is porting projects to .Net Core so it seemed
this would be worthwhile.  I&rsquo;ve tried to setup keybindings that are the ones I know from Visual Studio and installed couple of extensions to make things easier and prettier.</p>
<p>As VSCode is language agnostic the one thing I found was how to build .Net Core projects was a bit off.  For each project you have you have to configure a task runner.  VSCode tries to
help you here and gives you a few languages to choose from.  For .Net Core it creates a <code>dotnet build</code> task.  The problem with this is that it runs that command from the workspace root,
ie the folder where VSCode is opened.  What if you open it from the git root folder and your project(s) are under a src/MyProject folder?  It will fail as it cant find project.json.
What you can do is set the <code>cwd</code> to be a specific directory by hardcoding it in the task configuration but thats not great if you have multiple projects.  You could use some predefined
variables that VSCode provides eg/<code>${fileDirname}</code> but again if you are in a folder 4 levels deep that wont work either.</p>
<p>I wanted a Build All projects command and a Build Current project command but with the above limitations I set about investigating some terminal commands that could be run to get this to work
and below is what I came up with:</p>
<pre><code>{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    &quot;version&quot;: &quot;0.1.0&quot;,
    &quot;command&quot;: &quot;zsh&quot;,
    &quot;isShellCommand&quot;: true,
    &quot;showOutput&quot;: &quot;always&quot;,
    &quot;args&quot;: [
        &quot;-c&quot;
    ],
    &quot;options&quot;: {
        &quot;cwd&quot;: &quot;${fileDirname}&quot;
    },
    &quot;tasks&quot;: [{
        &quot;taskName&quot;: &quot;Build Current Project&quot;,
        &quot;suppressTaskName&quot;: true,
        &quot;isBuildCommand&quot;: true,
        &quot;args&quot;: [
            &quot;setopt extended_glob &amp;&amp; print -l (../)#project.json(:h) | xargs dotnet build&quot;
        ],
        &quot;problemMatcher&quot;: &quot;$msCompile&quot;
    }, {
        &quot;taskName&quot;: &quot;Build All Projects&quot;,
        &quot;suppressTaskName&quot;: true,
        &quot;isBuildCommand&quot;: true,
        &quot;args&quot;: [
            &quot;cd ${workspaceRoot} &amp;&amp; dotnet build ./**/**/project.json &amp;&amp; echo Build Completed&quot;
        ],
        &quot;problemMatcher&quot;: &quot;$msCompile&quot;
    }]
} 
</code></pre>
<p><strong>One thing to note, this will only work for OSX/Linux users with ZSH.</strong></p>
<p>So what we have is a build task that runs a command (the first task) which calls out to <code>zsh</code> with the argument <code>-c</code> that shows the output in the task panel within VSCode and it executes it
within the current file&rsquo;s directory.  This then calls <code>setopt extended_glob</code> to turn on ZSH extended globbing, it finds the closest parent directory that has a project.json and then passes
that to <code>xargs</code> which will execute <code>dotnet build</code> with the output from the glob.</p>
<p>We also have another task which will build all projects by changing directory to the workspace root and then running <code>dotnet build</code> with a glob pattern to find all the folders with project.json
inside of them.  You will have to change that glob pattern to fit your folder structure but this is what works for the <a href="http://nancyfx.org">NancyFX</a> project.</p>
<p>To invoke these presee <code>CMD + P</code> and type <code>task</code> and add a space after task, VSCode will list your tasks, you can then execute either Build Current Project or Build All Projects.</p>
<p>Have fun!</p>
    </div> 
    
        <div id="tagcloud">   
            
            
                <a href="/tags/vscode/"><span>VSCode</span></a>
            
                <a href="/tags/asp.net/"><span>ASP.Net</span></a>
                     
        </div>
    
    
    <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <meta itemprop="name" content="Jonathan Channon">
    </span>
    
<div id="disqus_thread"></div>
<script>

    


    var disqus_config = function () {
        this.page.url = '\/2016-07-13-building-all-current-dotnet-core-projects-vscode\/';  
        this.page.identifier = ''; 
    };

    (function () { 
        var d = document, s = d.createElement('script');
        s.src = '//jonathanchannonblog.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>

        </div>
        
    </div>
</div>



<div class="footer_social">
    <div class="footer_social_inner">
        <div class="container">
            
                <a class="social-twitter" data-hint="Twitter" title="Twitter" href="https://twitter.com/jchannon" rel="me">Twitter</a>
            
            
                <a class="social-github" data-hint="Github" title="Github" href="https://github.com/jchannon" rel="me">Github</a>
            
            
                <a class="social-linkedin" data-hint="LinkedIn" title="Linked In" href="http://uk.linkedin.com/in/jonathanchannon" rel="me">Linked In</a>
            
            
                <a href="/feed.xml" class="social-rss">RSS Feed</a>
            
        </div>
    </div>
</div>



</div>


<script src="//js/libs/modernizr.min.js"></script>
<script src="//js/libs/respond.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>


<script src="//js/general.js"></script>
<script src="//js/hoverIntent.js"></script>

<script type='text/javascript'>
    $(function () {
        $("pre code").parent().each(function () {
            if (!$(this).hasClass("prettyprint")) {
                $(this).addClass("prettyprint");
                a = true
            }
        });
        
    });
</script>
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?skin=sons-of-obsidian"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-123-45', 'auto');
	
	ga('send', 'pageview');
}
</script>


</body>

</html>
