<!DOCTYPE HTML>

<html lang='en'>
	<head>
		<title>Nancy, ASP.Net vNext, OSX and Sublime Text &middot; Jonathan Channon Blog</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		
		
		
		<link rel="stylesheet" href="/assets/css/main.min.css">
		
		
		
		<noscript><link rel="stylesheet" href='/assets/css/noscript.css' /></noscript>
	</head>

	<body lang='en' class="is-preload">

		
			<div id="wrapper">

                
<header id="header">
    <a href='/' class="logo">Blog</a>
</header>

                

<nav id="nav">
    <ul class="links">
        <li class="active"><a href='/'>Blog</a></li>
        
        
    </ul>
    
    <ul class="icons">
        
        <li><a href="https://twitter.com/jchannon" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
        
        
        <li><a href="https://github.com/jchannon" class="icon fa-github"><span class="label">GitHub</span></a></li>
        
        
        
        
        <li><a href="https://www.linkedin.com/in/jonathanchannon/" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
        
        
        
        
        
    </ul>
    
</nav>


				
					<div id="main">

						
                        <section class="post">
                            <header class="major">
                                
                                <span class="date">Tue, Aug 5, 2014</span>
                                
                                <h1>Nancy, ASP.Net vNext, OSX and Sublime Text</h1>
                                <p></p>
                            </header>
                            
                            <p>One of the great things that ASP.Net vNext is bringing is the ability to use it cross platform with Microsoft actively testing their libraries against <a href="http://www.mono-project.com/Main_Page">Mono</a>.  Along with this MS are developing a web server that is cross platform and goes by the name of <a href="https://github.com/aspnet/KestrelHttpServer">Kestrel</a>.  One thing they aren&rsquo;t doing, yet, is making Visual Studio cross platform so we need something to write our code in.  There a few editors out there but one of the most common is <a href="http://www.sublimetext.com/3">Sublime Text</a>.  This gives you syntax highlighting and build systems that can all be configured so if you are not aware of it check it out.  Obviously before we can start writing code on OSX with our editor we need Mono installed.</p>
<p><strong>UPDATE - As of August 13th 2014 there is a Mono 3.6 release which means you no longer need to compile Mono but you will need to install Homebrew for ASP.Net vNext. <a href="#vnext">Skip to nnext section</a></strong></p>
<p>At the time of writing the official binary for Mono is 3.4.0 and this does not include some features needed for ASP.Net vNext to run so we are going to have to manually compile Mono ourselves.  Now I know this sounds scary but its not as bad as it seems and I&rsquo;ve gone through the pain of setting it up so hopefully this blog post should make it easier for you</p>
<p>There is a <a href="http://mono-project.com/Compiling_Mono_on_OSX">guide</a> on Mono&rsquo;s website on how to compile but I found some issues with it.  I&rsquo;m running on OSX Mavericks so I&rsquo;m not sure if that resulted in issues but here&rsquo;s my guide to get it compiling.</p>
<p>Download 3.4.0 from <a href="http://www.go-mono.com/mono-downloads/download.html">here</a> and install with the PKG installer because when compiling the latest Mono source it needs a compiler on the machine.</p>
<p>Install <a href="http://brew.sh/">Homebrew</a> and install the dependencies as shown in Mono&rsquo;s guide. The guide discusses compiling these dependencies but it conflicted with something already on the system.</p>
<pre><code>brew install autoconf
brew install automake
brew install libtool
</code></pre>
<p><strong>NOTE:</strong> You could install Mono using Homebrew if you wish but I didn&rsquo;t realise this until afterwards</p>
<p>Copy the below and put it in a <code>mymonoinstall.sh</code> file. Make <strong>$PREFIX</strong> to be a folder on your system, I used <code>/Users/jonathanchannon/mono</code></p>
<pre><code>PATH=$PREFIX/bin:$PATH
git clone https://github.com/mono/mono.git
cd mono
CC='cc -m32' ./autogen.sh --prefix=$PREFIX --disable-nls --build=i386-apple-darwin11.2.0
sudo make
sudo make install
</code></pre>
<p>Execute this by typing <code>mymonoinstall.sh</code> in a terminal under the folder where the file is. This may take some time based on your internet connection and power of your machine but once done you should be able to run <code>mono --version</code> and hopefully see something greater than 3.4.0.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
Now we have Mono installed we&rsquo;re ready to start coding so download <a href="http://www.sublimetext.com/3">Sublime Text 3</a> and install it.  Once installed we need to install the ASP.Net vNext tools using the following instructions:</p>
<pre><code>brew tap aspnet/k
brew install kvm
</code></pre>
<p>Create a <code>.profile</code> file in your home directory and enter <code>source kvm.sh</code>. This is so the system knows what the kvm command is when its typed into the console.</p>
<p>We now need to install the <a href="https://github.com/ligershark/Kulture">Kulture</a> Sublime plugin that will enable us to run ASP.Net vNext from Sublime.  In Sublime open the console <code>View -&gt; Show Console</code> and paste in the below</p>
<pre><code>import urllib.request,os,hashlib; h = '7183a2d3e96f11eeadd761d777e62404' + 'e330c659d4bb41d3bdf022e94cab3cd0'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( 'http://sublime.wbond.net/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); print('Error validating download (got %s instead of %s), please try manual install' % (dh, h)) if dh != h else open(os.path.join( ipp, pf), 'wb' ).write(by)
</code></pre>
<p><strong>NOTE: These instructions are for Sublime Text 3. At the time of writing Kulture is only supported on version 3 so if you have version 2 you&rsquo;re out of luck I&rsquo;m afraid</strong></p>
<p>This will install a package manager for Sublime, you can never have too many package managers eh!</p>
<p><code>Bring up the Command Palette in Sublime (Cmd + Shift + P)</code></p>
<p><code>Select Package Control: Install Package</code></p>
<p><code>Select Kulture when the list appears.</code></p>
<p>So now we have the ability to run, restore and build our ASP.Net vNext apps in Sublime we&rsquo;re ready to create a Nancy app.  Now you could create 4 files manually and build and run them but we might as well install another package manager that will create a Nancy app for us!  I&rsquo;ve made a <a href="http://yeoman.io/">Yeoman</a> plugin which <a href="https://www.npmjs.org/package/generator-nancy">creates a Hello World app</a> in Nancy for ASP.Net vNext which can be opened in Sublime.</p>
<p>Go and install <a href="http://nodejs.org/">Node.js</a> and then open up a terminal and type:</p>
<pre><code>npm install -g yo
npm install -g generator-nancy
</code></pre>
<p>Go to a folder in your terminal and type <code>yo nancy</code>, it will ask you what you want to call your app, you can type something in or accept the default and it will create the files needed to create the app.  It will also do a NuGet restore for all the dependencies the app has.  In Sublime go to <code>File -&gt; Open Folder</code> and select the folder with your app in.</p>
<p><code>Go to Tools -&gt; Build System and select ASP.Net</code></p>
<p><code>Type Cmd + B</code></p>
<p><code>You should see the build output in the Sublime console</code></p>
<p><code>Bring up the Command Palette in Sublime (Cmd + Shift + P)</code></p>
<p><code>Type 'K' and select Run K commands</code></p>
<p><code>Select Kestrel and a terminal window will open and you should see 'Started'</code></p>
<p><code>Open a browser and go to http://localhost:5000 and you should see 'Hello World' from your Nancy app</code></p>
<p>There we have it, a Nancy ASP.Net vNext building and running from Sublime Text.  Here&rsquo;s a video to prove it works!</p>
<!-- raw HTML omitted -->
<p><strong>Tip</strong> : Put a syntax error in your code and build your app and see the error reported in the Sublime console.  Double click that error line and watch it open the offending file!</p>
<p>For bonus points you can have a play with <a href="https://github.com/moonrabbit/OmniSharpSublime">this plugin</a> that aims to give C# intellisense in Sublime!</p>
<p>Have fun!</p>

                            
                            
                            
                            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "jonathanchannonblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                            
                        </section>

					</div>

                    

<footer id="footer">
    
    <section class="split contact">
        
        
        
        
        <section>
            <h3>Social</h3>
            <ul class="icons alt">
                
                <li><a href="https://twitter.com/jchannon" class="icon alt fa-twitter"><span class="label">Twitter</span></a></li>
                
                
                <li><a href="https://github.com/jchannon" class="icon alt fa-github"><span class="label">GitHub</span></a></li>
                
                
                
                
                <li><a href="https://www.linkedin.com/in/jonathanchannon/" class="icon alt fa-linkedin"><span class="label">LinkedIn</span></a></li>
                
                
                
                
                
            </ul>
        </section>
        
    </section>
</footer>

                    
<div id="copyright">
    <ul><li>&copy; Blog</li><li>Design: <a href="https://html5up.net">HTML5 UP</a></li><li>Hugo Port: <a href="https://curtistimson.co.uk">curttimson</a></li></ul>
</div>


            </div>
            
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-7138405-4', 'auto');
	
	ga('send', 'pageview');
}
</script>
            










<script src='/assets/js/bundle.js'></script>


	</body>
</html>
